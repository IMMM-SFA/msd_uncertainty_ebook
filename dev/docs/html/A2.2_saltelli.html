
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sobol SA Tutorial &#8212; Addressing Uncertainty in MultiSector Dynamics Research  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=0a66277c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'A2.2_saltelli';</script>
    <script src="_static/custom.js?v=d380ae45"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z9WMRS23CZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z9WMRS23CZ');
</script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Addressing Uncertainty in MultiSector Dynamics Research  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Suggested Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contribution Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_diagnostic_modeling_overview_and_perspectives.html">2. Diagnostic Modeling Overview and Perspectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_sensitivity_analysis_the_basics.html">3. Sensitivity Analysis: The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_sensitivity_analysis_diagnostic_and_exploratory_modeling.html">4. Sensitivity Analysis: Diagnostic &amp; Exploratory Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_conclusion.html">5. Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A1_Uncertainty_Quantification.html">A. Uncertainty Quantification</a></li>
<li class="toctree-l1"><a class="reference internal" href="A2_Jupyter_Notebooks.html">B. Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="A3_plotting_code.html">C. Plotting Code Samples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="6_glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="R.Bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/IMMM-SFA/msd_uncertainty_ebook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/IMMM-SFA/msd_uncertainty_ebook/issues/new?title=Issue%20on%20page%20%2FA2.2_saltelli.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/A2.2_saltelli.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sobol SA Tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-sensitivity-analysis-sa-using-the-saltelli-sampling-scheme-with-sobol-sa">Tutorial: Sensitivity Analysis (SA) using the Saltelli sampling scheme with Sobol SA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-get-started">Let‚Äôs get started!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generate-the-problem-dictionary">Step 1: Generate the problem dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-samples-using-the-saltelli-sampling-scheme">Step 2: Generate samples using the Saltelli sampling scheme</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-execute-the-ishigami-function-over-our-sample-set">Step 3: Execute the Ishigami function over our sample set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compute-first-second-and-total-order-sensitivity-indices-using-the-sobol-method">Step 4: Compute first-, second-, and total-order sensitivity indices using the Sobol method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-interpret-our-results">Step 5: Interpret our results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-to-apply-sobol-sa-to-your-own-problem">Tips to Apply Sobol SA to Your Own Problem</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="sobol-sa-tutorial">
<h1>Sobol SA Tutorial<a class="headerlink" href="#sobol-sa-tutorial" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="line-block">
<div class="line">Run the tutorial interactively:  <a class="reference external" href="https://uc-ebook-dev.msdlive.org/user-redirect/lab/tree/notebooks/sa_saltelli_sobol_ishigami.ipynb">Sobol SA Tutorial</a>.</div>
<div class="line">Please be aware that notebooks can take a couple minutes to launch.</div>
<div class="line">To run the notebooks yourself, download the files <a class="reference external" href="https://github.com/IMMM-SFA/msd_uncertainty_ebook/tree/main/notebooks">here</a> and use these <a class="reference external" href="https://github.com/IMMM-SFA/msd_uncertainty_ebook/blob/main/pyproject.toml">requirements</a>.</div>
</div>
</div>
<section id="tutorial-sensitivity-analysis-sa-using-the-saltelli-sampling-scheme-with-sobol-sa">
<h2>Tutorial: Sensitivity Analysis (SA) using the Saltelli sampling scheme with Sobol SA<a class="headerlink" href="#tutorial-sensitivity-analysis-sa-using-the-saltelli-sampling-scheme-with-sobol-sa" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will set up a workflow to investigate how sensitive
the output of a function is to its inputs. Why might you want to do
this? Imagine that this function represents a complex system, such as
the rainfall-runoff process of a watershed model, and that you, the
researcher, want to investigate how your choice of input parameter
values are affecting the model‚Äôs characterization of runoff in the
watershed. Your parameter values are likely uncertain and can take on
any value in a pre-defined range. Using a Sobol SA will allow you to
sample different values of your parameters and calculate how sensitive
your output of interest is to certain parameters. Below, we demonstrate
Sobol SA for a simple function to illustrate the method, but the
workflow can be applied to your own problem of interest!</p>
<p>In order to conduct this analysis, we will use the popular Python
Sensitivity Analysis Library
(<a class="reference external" href="https://salib.readthedocs.io/en/latest/index.html">SALib</a>) to:</p>
<ol class="arabic simple">
<li><p>Generate a problem set as a dictionary for our Ishigami function that has three inputs</p></li>
<li><p>Generate 2048 samples for our problem set using the Saltelli <a class="footnote-reference brackets" href="#id7" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#id8" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> sampling scheme</p></li>
<li><p>Execute the Ishigami function for each of our samples and gather the outputs</p></li>
<li><p>Compute the sensitivity analysis to generate first-order and total-order sensitivity indices using the Sobol <a class="footnote-reference brackets" href="#id9" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> method</p></li>
<li><p>Interpret the meaning of our results</p></li>
</ol>
<section id="lets-get-started">
<h3>Let‚Äôs get started!<a class="headerlink" href="#lets-get-started" title="Link to this heading">#</a></h3>
<p><strong>NOTE</strong>: Content from this tutorial is taken directly from the SALib
<a class="reference external" href="https://salib.readthedocs.io/en/latest/basics.html">‚ÄúBasics‚Äù</a>
walkthrough.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import relevant libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">SALib.sample.sobol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sobol_sample</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">SALib.analyze</span><span class="w"> </span><span class="kn">import</span> <span class="n">sobol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">SALib.test_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ishigami</span>
</pre></div>
</div>
</section>
<section id="step-1-generate-the-problem-dictionary">
<h3>Step 1: Generate the problem dictionary<a class="headerlink" href="#step-1-generate-the-problem-dictionary" title="Link to this heading">#</a></h3>
<p>The Ishigami function is of the form:</p>
<div class="math notranslate nohighlight">
\[f(x_1,x_2,x_3) = sin(x_1)+asin^2(x_2)+bx_3^4sin(x_1)\]</div>
<p>The function has three inputs, ùë•1, ùë•2, ùë•3 where ùë•ùëñ ‚àà [‚àíùúã, ùúã]. The
constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are defined as 7.0 and 0.1
respectively.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a problem dictionary. Here we supply the number of variables, the names of each variable, and the bounds of the variables.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;num_vars&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;bounds&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">3.14159265359</span><span class="p">,</span> <span class="mf">3.14159265359</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mf">3.14159265359</span><span class="p">,</span> <span class="mf">3.14159265359</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mf">3.14159265359</span><span class="p">,</span> <span class="mf">3.14159265359</span><span class="p">]]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="step-2-generate-samples-using-the-saltelli-sampling-scheme">
<h3>Step 2: Generate samples using the Saltelli sampling scheme<a class="headerlink" href="#step-2-generate-samples-using-the-saltelli-sampling-scheme" title="Link to this heading">#</a></h3>
<p>Sobol SA requires the use of the Saltelli sampling scheme. The output of
the <code class="docutils literal notranslate"><span class="pre">saltelli.sample</span></code> function is a NumPy array that is of shape 2048
by 3. The sampler generates ùëÅ‚àó(2ùê∑+2) samples, where in this example, N
is 256 (the argument we supplied) and D is 3 (the number of model
inputs), yielding 2048 samples. The keyword argument
<code class="docutils literal notranslate"><span class="pre">calc_second_order=False</span></code> will exclude second-order indices, resulting
in a smaller sample matrix with ùëÅ‚àó(ùê∑+2) rows instead. Below, we plot the
resulting Saltelli sample.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate parmeter values using the saltelli.sample function</span>
<span class="n">param_values</span> <span class="o">=</span> <span class="n">sobol_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`param_values` shape:  </span><span class="si">{</span><span class="n">param_values</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block"><cite>param_values</cite> shape:  (2048, 3)</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the 2048 samples of the parameters</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span> <span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">param_values</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">param_values</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">param_values</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X1 Parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;X2 Parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;X3 Parameter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Saltelli Sample of Parameter Values&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_7_0.png" src="_images/output_7_0.png" />
</section>
<section id="step-3-execute-the-ishigami-function-over-our-sample-set">
<h3>Step 3: Execute the Ishigami function over our sample set<a class="headerlink" href="#step-3-execute-the-ishigami-function-over-our-sample-set" title="Link to this heading">#</a></h3>
<p>SALib provides a nice wrapper to the Ishigami function that allows the
user to directly pass the <code class="docutils literal notranslate"><span class="pre">param_values</span></code> array we just generated into
the function directly.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Ishigami</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">param_values</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-4-compute-first-second-and-total-order-sensitivity-indices-using-the-sobol-method">
<h3>Step 4: Compute first-, second-, and total-order sensitivity indices using the Sobol method<a class="headerlink" href="#step-4-compute-first-second-and-total-order-sensitivity-indices-using-the-sobol-method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">sobol.analyze</span></code> function will use our problem dictionary and the
result of the Ishigami runs (<code class="docutils literal notranslate"><span class="pre">Y</span></code>) to compute first-, second-, and
total-order indicies.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Si</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Si</span></code> is a Python dict with the keys ‚ÄúS1‚Äù, ‚ÄúS2‚Äù, ‚ÄúST‚Äù, ‚ÄúS1_conf‚Äù,
‚ÄúS2_conf‚Äù, and ‚ÄúST_conf‚Äù. The <code class="docutils literal notranslate"><span class="pre">_conf</span></code> keys store the corresponding
confidence intervals, typically with a confidence level of 95%. Use the
keyword argument <code class="docutils literal notranslate"><span class="pre">print_to_console=True</span></code> to print all indices. Or, we
can print the individual values from <code class="docutils literal notranslate"><span class="pre">Si</span></code> as shown in the next step.</p>
</section>
<section id="step-5-interpret-our-results">
<h3>Step 5: Interpret our results<a class="headerlink" href="#step-5-interpret-our-results" title="Link to this heading">#</a></h3>
<p>We execute the following code and take a look at our first-order indices
(<code class="docutils literal notranslate"><span class="pre">S1</span></code>) for each of our three inputs. These indicies can be interpreted
as the fraction of variance in the output that is explained by each
input individually.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_order</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First-order:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1: </span><span class="si">{</span><span class="n">first_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, x2: </span><span class="si">{</span><span class="n">first_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, x3: </span><span class="si">{</span><span class="n">first_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">First</span><span class="o">-</span><span class="n">order</span><span class="p">:</span>
<span class="n">x1</span><span class="p">:</span> <span class="mf">0.3184242969763115</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="mf">0.4303808201623416</span><span class="p">,</span> <span class="n">x3</span><span class="p">:</span> <span class="mf">0.022687722804980225</span>
</pre></div>
</div>
<p>If we were to rank the importance of the inputs in how much they
individually explain the variance in the output, we would rank them from
greatest to least importance as follows: ùë•2, ùë•1 and then ùë•3. Since ùë•3
only explains 2% of the output variance, it does not explain output
variability meaningfully. Thus, this indicates that there is
contribution to the output variance by ùë•2 and ùë•1 independently, whereas
ùë•3 does not contribute to the output variance. Determining what inputs
are most important or what index value is meaningful is a common
question, but one for which there is no general rule or threshold. This
question is problem and context-dependent, but procedures have been
identified to rank order influential inputs and which can be used to
identify the least influential factors. These factors can be fixed to
simplify the model <a class="footnote-reference brackets" href="#id10" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#id12" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#id13" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
<p>Next, we evaluate the total-order indices, which measure the
contribution to the output variance caused by varying the model input,
including both its first-order effects (the input varying alone) and all
higher-order interactions across the input parameters.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_order</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s1">&#39;ST&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total-order:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1: </span><span class="si">{</span><span class="n">total_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, x2: </span><span class="si">{</span><span class="n">total_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, x3: </span><span class="si">{</span><span class="n">total_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span><span class="o">-</span><span class="n">order</span><span class="p">:</span>
<span class="n">x1</span><span class="p">:</span> <span class="mf">0.5184119098161343</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="mf">0.41021260250026054</span><span class="p">,</span> <span class="n">x3</span><span class="p">:</span> <span class="mf">0.2299058431439953</span>
</pre></div>
</div>
<p>The magnitude of the total order indices are substantially larger than
the first-order indices, which reveals that higher-order interactions
are occurring, i.e.¬†that the interactions across inputs are also
explaining some of the total variance in the output. Note that ùë•3 has
non-negligible total-order indices, which indicates that it is not a
consequential parameter when considered in isolation, but becomes
consequential and explains 25% of variance in the output through its
interactions with ùë•1 and ùë•2.</p>
<p>Finally, we can investigate these higher order interactions by viewing
the second-order indices. The second-order indicies measure the
contribution to the output variance caused by the interaction between
any two model inputs. Some computing error can appear in these
sensitivity indices, such as negative values. Typically, these computing
errors shrink as the number of samples increases.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_order</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s1">&#39;S2&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second-order:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1-x2:  </span><span class="si">{</span><span class="n">second_order</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1-x3:  </span><span class="si">{</span><span class="n">second_order</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x2-x3:  </span><span class="si">{</span><span class="n">second_order</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Second</span><span class="o">-</span><span class="n">order</span><span class="p">:</span>
<span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">:</span>  <span class="o">-</span><span class="mf">0.043237389723234154</span>
<span class="n">x1</span><span class="o">-</span><span class="n">x3</span><span class="p">:</span>  <span class="mf">0.17506452088709862</span>
<span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="p">:</span>  <span class="o">-</span><span class="mf">0.03430682392607577</span>
</pre></div>
</div>
<p>We can see that there are strong interactions between ùë•1 and ùë•3. Note
that in the Ishigami function, these two variables are multiplied in the
last term of the function, which leads to interactive effects. If we
were considering first order indices alone, we would erroneously assume
that ùë•3 explains no variance in the output, but the second-order and
total order indices reveal that this is not the case. It‚Äôs easy to
understand where we might see interactive effects in the case of the
simple Ishigami function. However, it‚Äôs important to remember that in
more complex systems, there may be many higher-order interactions that
are not apparent, but could be extremely consequential in explaining the
variance of the output.</p>
</section>
<section id="tips-to-apply-sobol-sa-to-your-own-problem">
<h3>Tips to Apply Sobol SA to Your Own Problem<a class="headerlink" href="#tips-to-apply-sobol-sa-to-your-own-problem" title="Link to this heading">#</a></h3>
<p>In this tutorial, we demonstrated how to apply an SA analysis to a
simple mathematical test function. In order to apply a Sobol SA to your
own problem, you will follow the same general workflow that we defined
above. You will need to:</p>
<ol class="arabic simple">
<li><p>Choose sampling bounds for your parameters and set up the problem
dictionary as in Step 1 above.</p></li>
<li><p>Generate samples using the <code class="docutils literal notranslate"><span class="pre">saltelli.sample</span></code> function. This step is
problem-dependent and note that the Sobol method can be
computationally intensive depending on the model being analyzed. For
example, for a simple rainfall-runoff model such as HYMOD, it has
been recommended to run a sample size of at least N = 10,000 (which
translates to 60,000 model runs). More complex models will be slower
to run and will also require more samples to calculate accurate
estimates of Sobol indices. Once you complete this process, pay
attention to the confidence bounds on your sensitivity indices to see
whether you need to run more samples.</p></li>
<li><p>Run the parameter sets through your model. In the example above, the
Ishigami function could be evaluated through SALib since it is a
built in function. For your application, you will need to run these
parameter sets through the problem externally and save the output.
The output file should contain one row of output values for each
model run.</p></li>
<li><p>Calculate the Sobol indices. Now, the Y will be a numpy array with
your external model output and you will need to include the parameter
samples as an additional argument.</p></li>
<li><p>Finally, we interpet the results. If the confidence intervals of your
dominant indices are larger than roughly 10% of the value itself, you
may want to consider increasing your sample size as computation
permits. You should additionally read the references noted in Step 5
above to understand more about identifying important factors.</p></li>
</ol>
<p><strong>References</strong></p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Saltelli, A. (2002). ‚ÄúMaking best use of model evaluations to compute sensitivity indices.‚Äù Computer Physics Communications, 145(2):280-297, doi:<a class="reference external" href="https://doi.org/10.1016/S0010-4655(02)00280-1">10.1016/S0010-4655(02)00280-1</a>.</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Saltelli, A., P. Annoni, I. Azzini, F. Campolongo, M. Ratto, and S. Tarantola (2010). ‚ÄúVariance based sensitivity analysis of model output. Design and estimator for the total sensitivity index.‚Äù Computer Physics Communications, 181(2):259-270, doi:<a class="reference external" href="https://doi.org/10.1016/j.cpc.2009.09.018">10.1016/j.cpc.2009.09.018</a>.</p>
</aside>
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Sobol, I. M. (2001). ‚ÄúGlobal sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates.‚Äù Mathematics and Computers in Simulation, 55(1-3):271-280, doi:<a class="reference external" href="https://doi.org/10.1016/S0378-4754(00)00270-6">10.1016/S0378-4754(00)00270-6</a>.</p>
</aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>T. H. Andres, ‚ÄúSampling methods and sensitivity analysis for large parameter sets,‚Äù Journal of Statistical Computation and Simulation, vol.¬†57, no. 1‚Äì4, pp.¬†77‚Äì110, Apr.¬†1997, doi:<a class="reference external" href="https://doi.org/10.1080/00949659708811804">10.1080/00949659708811804</a>.</p>
</aside>
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>Y. Tang, P. Reed, T. Wagener, and K. van Werkhoven, ‚ÄúComparing sensitivity analysis methods to advance lumped watershed model identification and evaluation,‚Äù Hydrology and Earth System Sciences, vol.¬†11, no. 2, pp.¬†793‚Äì817, Feb.¬†2007, doi:<a class="reference external" href="https://doi.org/10.5194/hess-11-793-2007">10.5194/hess-11-793-2007</a>.</p>
</aside>
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>J. Nossent, P. Elsen, and W. Bauwens, ‚ÄúSobol‚Äô sensitivity analysis of a complex environmental model,‚Äù Environmental Modelling &amp; Software, vol.¬†26, no. 12, pp.¬†1515‚Äì1525, Dec.¬†2011, doi:<a class="reference external" href="https://doi.org/10.1016/j.envsoft.2011.08.010">10.1016/j.envsoft.2011.08.010</a>.</p>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-sensitivity-analysis-sa-using-the-saltelli-sampling-scheme-with-sobol-sa">Tutorial: Sensitivity Analysis (SA) using the Saltelli sampling scheme with Sobol SA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-get-started">Let‚Äôs get started!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generate-the-problem-dictionary">Step 1: Generate the problem dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-samples-using-the-saltelli-sampling-scheme">Step 2: Generate samples using the Saltelli sampling scheme</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-execute-the-ishigami-function-over-our-sample-set">Step 3: Execute the Ishigami function over our sample set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compute-first-second-and-total-order-sensitivity-indices-using-the-sobol-method">Step 4: Compute first-, second-, and total-order sensitivity indices using the Sobol method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-interpret-our-results">Step 5: Interpret our results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-to-apply-sobol-sa-to-your-own-problem">Tips to Apply Sobol SA to Your Own Problem</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2022-current, Battelle Memorial Institute.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>